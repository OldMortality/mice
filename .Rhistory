'female' = female_long,
# type as dummy variable
'type_1' = type_1_long,
'type_2' = type_2_long,
# time as dummy variable
'time3' =  per_long == 1,
'time10' = per_long == 2,
'time17' = per_long == 3,
'time24' = per_long == 4,
'N' = length(R_long))
return(theList)
}
theList <- createList(mice)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
a8 * time31[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
a8 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
##
## Rename bugs output, so it is a bit more user friendly
##
renameSamples <- function(samples){
return(data.frame(samples$BUGSoutput$sims.list))
# result <- data.frame(
#   a0 = samples$BUGSoutput$sims.list$a0,
#   a1 = samples$BUGSoutput$sims.list$a1,
#   a2 =  samples$BUGSoutput$sims.list$a2,
#   a3 =  samples$BUGSoutput$sims.list$a3,
#   a4 =  samples$BUGSoutput$sims.list$a4,
#   a5 =  samples$BUGSoutput$sims.list$a5,
#   a6 =  samples$BUGSoutput$sims.list$a6,
#   a7 =  samples$BUGSoutput$sims.list$a7,
#   a8 =  samples$BUGSoutput$sims.list$a8,
#   b1 =  samples$BUGSoutput$sims.list$b1,
#   b2 =  samples$BUGSoutput$sims.list$b2,
#   b3 =  samples$BUGSoutput$sims.list$b3,
#   b4 =  samples$BUGSoutput$sims.list$b4,
#   g1 =  samples$BUGSoutput$sims.list$g1,
#   g2 =  samples$BUGSoutput$sims.list$g2,
#   g3 =  samples$BUGSoutput$sims.list$g3,
#   g4 =  samples$BUGSoutput$sims.list$g3,
#   sigma =  samples$BUGSoutput$sims.list$sigma)
#p =  samples$BUGSoutput$sims.list$p,
#b = samples$BUGSoutput$sims.list$b)
return(result)
}
parameters <- c("a0", "a1","a2","a3","a4","a5",
"a6","a7","a8","b1","b2","b3","b4",
"sigma","p","b")
getSamples <- function(model,data,parameters) {
samples <- jags(model = mouseModel ,
data = theList,
parameters ,
n.chains = 4,
n.iter = 5000,
n.burnin = 1000,
inits = setInits(i1 = 0,i2 = 0.1,i3 = -0.1,i4 = 0.245),
n.thin = 1,
DIC = T)
return(renameSamples(samples))
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
a8 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
parameters <- c("a0", "a1","a2","a3","a4","a5",
"a6","a7","b1","b2","b3","b4",
"sigma","p","b")
getSamples <- function(model,data,parameters) {
samples <- jags(model = mouseModel ,
data = theList,
parameters ,
n.chains = 4,
n.iter = 5000,
n.burnin = 1000,
inits = setInits(i1 = 0,i2 = 0.1,i3 = -0.1,i4 = 0.245),
n.thin = 1,
DIC = T)
return(renameSamples(samples))
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[j]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
getSamples <- function(model,data,parameters) {
samples <- jags(model = mouseModel ,
data = theList,
parameters ,
n.chains = 4,
n.iter = 5000,
n.burnin = 1000,
inits = setInits(i1 = 0,i2 = 0.1,i3 = -0.1,i4 = 0.245),
n.thin = 1,
DIC = T)
return(renameSamples(samples))
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau);
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i]
#+
#b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
getSamples <- function(model,data,parameters) {
samples <- jags(model = mouseModel ,
data = theList,
parameters ,
n.chains = 4,
n.iter = 5000,
n.burnin = 1000,
inits = setInits(i1 = 0,i2 = 0.1,i3 = -0.1,i4 = 0.245),
n.thin = 1,
DIC = T)
return(renameSamples(samples))
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
theList
theList$mouse[156]
theList$period[156]
theList$N
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau)
logit(p[mouse[i], period[i]]) <-
a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
theList$period
length(theList$period)
mouseModel
mouseModel <- function()
{
for ( i in 1 : N) {
R[i] ~ dbin(p[mouse[i], period[i]],Ncells[i])
b[mouse[i], period[i]] ~ dnorm(0.0, tau)
logit(p[mouse[i], period[i]]) <- a0 +
a1 * female[i] +
a2 * type_1[i] +
a3 * type_2[i] +
a4 * time3[i] +
a5 * time10[i] +
a6 * time17[i] +
a7 * time24[i] +
b1 * time3[i] * type_2[i] +
b2 * time10[i] * type_2[i] +
b3 * time17[i] * type_2[i] +
b4 * time24[i] * type_2[i] +
g1 * time3[i] * type_1[i] +
g2 * time10[i] * type_1[i] +
g3 * time17[i] * type_1[i] +
g4 * time24[i] * type_1[i] +
b[mouse[i],period[i]]
}
# priors
a0 ~ dnorm(0.0,1.0E-6)
a1 ~ dnorm(0.0,1.0E-6)
a2 ~ dnorm(0.0,1.0E-6)
a3 ~ dnorm(0.0,1.0E-6)
a4 ~ dnorm(0.0,1.0E-6)
a5 ~ dnorm(0.0,1.0E-6)
a6 ~ dnorm(0.0,1.0E-6)
a7 ~ dnorm(0.0,1.0E-6)
b1 ~ dnorm(0.0,1.0E-6)
b2 ~ dnorm(0.0,1.0E-6)
b3 ~ dnorm(0.0,1.0E-6)
b4 ~ dnorm(0.0,1.0E-6)
g1 ~ dnorm(0.0,1.0E-6)
g2 ~ dnorm(0.0,1.0E-6)
g3 ~ dnorm(0.0,1.0E-6)
g4 ~ dnorm(0.0,1.0E-6)
tau <- pow(sigma, -2)
sigma ~ dunif(0,100)
}
samples <- getSamples(model=mouseModel,data=theList,parameters=parameters)
